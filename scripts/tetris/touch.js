"use strict";function _typeof(e){function t(e){return n.apply(this,arguments)}var n,a;function o(e){return a.apply(this,arguments)}return(_typeof="function"==typeof Symbol&&"symbol"===_typeof(Symbol.iterator)?(a=function(e){return void 0===e?"undefined":_typeof(e)},o.toString=function(){return a.toString()},o):(n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof(e)},t.toString=function(){return n.toString()},t))(e)}!function(){var c=[],m=document.getElementById("under_container");document.getElementById("layout");function e(e){if("BUTTON"!=e.target.tagName&&game.started&&e.preventDefault(),m.clientHeight<m.scrollHeight)for(var t=e.target;t.parentNode;t=t.parentNode)if(t.parentNode==m)return;game.started&&e.stopPropagation();for(var n=0,a=e.changedTouches.length;n<a;n++){var o=c.map(function(e){return e.id}).indexOf(e.changedTouches[n].identifier);if(-1==o)return;var i=c[o];i.release={x:e.changedTouches[n].clientX,y:e.changedTouches[n].clientY,time:e.timeStamp},i.ended=!0;var r=i.moves[Math.max(0,i.moves.length-4)];"swipe"==i.type&&2<=i.moves.length&&e.timeStamp-i.moves.last.time<50&&2*Math.abs(i.release.x-r.x)<i.release.y-r.y&&15<i.release.y-r.y?game.piece.drop():"tap"==i.type&&s(i.tapHalf,e.timeStamp),c.splice(o,1)}}function a(e,t,n){a.lastWasDown=t>Math.abs(e),t<=Math.abs(e)||(a.history.push({time:n}),game.piece.move("DOWN"))}function s(e,t){s.history.push({time:t}),game.piece.rotate(e)}a.history=[],a.lastWasDown=!1,a.repeat=function(e){a.lastWasDown&&a(0,10,e)},s.history=[],document.addEventListener("touchstart",function(e){if(!game.paused&&game.started){if(m.clientHeight<m.scrollHeight)for(var t=e.target;t.parentNode;t=t.parentNode)if(t.parentNode==m)return;"BUTTON"!=e.target.tagName&&e.preventDefault(),e.stopPropagation();for(var n=0,a=e.changedTouches.length;n<a;n++){var o={start:{x:e.changedTouches[n].clientX,y:e.changedTouches[n].clientY,tetrominoX:game.piece.x,time:e.timeStamp},moves:[],release:null,ended:!1,id:e.changedTouches[n].identifier,type:"tap",tapHalf:Math.floor(2*e.changedTouches[n].clientX/window.innerWidth)?"CLOCKWISE":"COUNTERCLOCKWISE",timeoutEndSwipe:null,timeoutHoldSwipe:null,downInterval:null};c.push(o),o.moves.last=o.start}}}),document.addEventListener("touchmove",function(s){if(!game.paused&&game.started){if(m.clientHeight<m.scrollHeight)for(var e=s.target;e.parentNode;e=e.parentNode)if(e.parentNode==m)return;s.preventDefault(),s.stopPropagation();for(var t=0,n=s.changedTouches.length;t<n;t++){var a=function(t){var e=c.filter(function(e){return e.id==s.changedTouches[t].identifier})[0];e.moves.last=e.moves.last||e.start;var n={x:s.changedTouches[t].clientX,y:s.changedTouches[t].clientY,tetrominoX:game.piece.x,dx:s.changedTouches[t].clientX-e.moves.last.x,dy:s.changedTouches[t].clientY-e.moves.last.y,dd:Math.hypot(s.changedTouches[t].clientX-e.moves.last.x,s.changedTouches[t].clientY-e.moves.last.y),angle:(Math.atan2(s.changedTouches[t].clientY-e.moves.last.y,s.changedTouches[t].clientX-e.moves.last.x)/Math.PI*180+360)%360,dtime:s.timeStamp-e.moves.last.timeStamp,time:s.timeStamp};if(0==n.dx&&0==n.dy)return{v:void 0};50<n.dtime&&(e.start=e.moves.last,e.moves=[]);var a,o=Math.round((n.x-e.start.x)/(1.1*game.minoWidth));if(game.piece.x!=e.start.tetrominoX+o&&!e.downInterval){e.type="swipe";for(var i=Math.max(0,Math.min(10-game.dimensions(game.piece).width,e.start.tetrominoX+o))-game.piece.x,r=Math.abs(i);0<r;r--)game.piece.move(i<0?"LEFT":"RIGHT")}5<n.y-e.start.y&&1.5*Math.abs(n.x-(e.moves[Math.max(0,e.moves.length-4)]||e.start).x)<n.y-(e.moves[Math.max(0,e.moves.length-4)]||e.start).y?(a=function(){if(e.ended||!e.downInterval)return e.downInterval=null;game.piece.move("DOWN")},e.type="swipe",game.piece.move("DOWN"),e.downInterval=setTimeout(function(){!e.ended&&e.downInterval&&(game.piece.move("DOWN"),e.downInterval=setInterval(a,250))},500)):(clearTimeout(e.downInterval),e.downInterval=null),e.moves.last=e.moves[e.moves.push(n)-1]}(t);if("object"===(void 0===a?"undefined":_typeof(a)))return a.v}}},{passive:!1}),document.addEventListener("touchend",e),document.addEventListener("touchcancel",e)}();